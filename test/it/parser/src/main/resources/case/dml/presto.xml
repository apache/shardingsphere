<?xml version="1.0" encoding="UTF-8"?>
<!--
  ~ Licensed to the Apache Software Foundation (ASF) under one or more
  ~ contributor license agreements.  See the NOTICE file distributed with
  ~ this work for additional information regarding copyright ownership.
  ~ The ASF licenses this file to You under the Apache License, Version 2.0
  ~ (the "License"); you may not use this file except in compliance with
  ~ the License.  You may obtain a copy of the License at
  ~
  ~     http://www.apache.org/licenses/LICENSE-2.0
  ~
  ~ Unless required by applicable law or agreed to in writing, software
  ~ distributed under the License is distributed on an "AS IS" BASIS,
  ~ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  ~ See the License for the specific language governing permissions and
  ~ limitations under the License.
  -->

<sql-parser-test-cases>
    <select sql-case-id="presto_select_assignment_operator">
        <from>
            <simple-table name="t_order" start-index="14" stop-index="20" />
        </from>
        <projections start-index="7" stop-index="7">
            <shorthand-projection start-index="7" stop-index="7" />
        </projections>
        <where start-index="22" stop-index="40">
            <expr>
                <binary-operation-expression start-index="28" stop-index="40">
                    <left>
                        <column name="order_id" start-index="28" stop-index="35" />
                    </left>
                    <operator>:=</operator>
                    <right>
                        <literal-expression value="1" start-index="40" stop-index="40" />
                    </right>
                </binary-operation-expression>
            </expr>
        </where>
    </select>

    <select sql-case-id="presto_select_literals">
        <from>
            <simple-table name="t_order" start-index="58" stop-index="79">
                <owner name="schem1" start-index="66" stop-index="71">
                    <owner name="catalog" start-index="58" stop-index="64" />
                </owner>
            </simple-table>
        </from>
        <projections start-index="7" stop-index="51">
            <expression-projection text="2020-01-01" start-index="7" stop-index="23">
                <expr>
                    <literal-expression value="2020-01-01" start-index="7" stop-index="23" />
                </expr>
            </expression-projection>
            <expression-projection text="X'1F'" start-index="26" stop-index="30">
                <expr>
                    <common-expression text="X'1F'" start-index="26" stop-index="30" />
                </expr>
            </expression-projection>
            <expression-projection text="B'1010'" start-index="33" stop-index="39">
                <expr>
                    <common-expression text="B'1010'" start-index="33" stop-index="39" />
                </expr>
            </expression-projection>
            <expression-projection text="true" start-index="42" stop-index="45">
                <expr>
                    <literal-expression value="true" start-index="42" stop-index="45" />
                </expr>
            </expression-projection>
            <expression-projection text="null" start-index="48" stop-index="51">
                <expr>
                    <literal-expression value="null" start-index="48" stop-index="51" />
                </expr>
            </expression-projection>
        </projections>
    </select>

    <select sql-case-id="presto_select_compare_all_subquery">
        <from>
            <simple-table name="t_order" start-index="14" stop-index="20" />
        </from>
        <projections start-index="7" stop-index="7">
            <shorthand-projection start-index="7" stop-index="7" />
        </projections>
        <where start-index="22" stop-index="77">
            <expr>
                <binary-operation-expression start-index="28" stop-index="77">
                    <left>
                        <column name="order_id" start-index="28" stop-index="35" />
                    </left>
                    <operator>= ALL</operator>
                    <right>
                        <subquery start-index="43" stop-index="77">
                            <select>
                                <from start-index="65" stop-index="76">
                                    <simple-table name="t_order_item" start-index="65" stop-index="76" />
                                </from>
                                <projections start-index="51" stop-index="58">
                                    <column-projection name="order_id" start-index="51" stop-index="58" />
                                </projections>
                            </select>
                        </subquery>
                    </right>
                </binary-operation-expression>
            </expr>
        </where>
    </select>

    <select sql-case-id="presto_select_or_boolean_true">
        <from>
            <simple-table name="t_order" start-index="14" stop-index="20" />
        </from>
        <projections start-index="7" stop-index="7">
            <shorthand-projection start-index="7" stop-index="7" />
        </projections>
        <where start-index="22" stop-index="55">
            <expr>
                <binary-operation-expression start-index="28" stop-index="55">
                    <left>
                        <binary-operation-expression start-index="28" stop-index="39">
                            <left>
                                <column name="flag" start-index="28" stop-index="31" />
                            </left>
                            <operator>IS</operator>
                            <right>
                                <literal-expression value="TRUE" start-index="36" stop-index="39" />
                            </right>
                        </binary-operation-expression>
                    </left>
                    <operator>OR</operator>
                    <right>
                        <binary-operation-expression start-index="44" stop-index="55">
                            <left>
                                <column name="order_id" start-index="44" stop-index="51" />
                            </left>
                            <operator>=</operator>
                            <right>
                                <literal-expression value="1" start-index="55" stop-index="55" />
                            </right>
                        </binary-operation-expression>
                    </right>
                </binary-operation-expression>
            </expr>
        </where>
    </select>

    <select sql-case-id="presto_select_not_flag">
        <from>
            <simple-table name="t_order" start-index="14" stop-index="20" />
        </from>
        <projections start-index="7" stop-index="7">
            <shorthand-projection start-index="7" stop-index="7" />
        </projections>
        <where start-index="22" stop-index="35">
            <expr>
                <not-expression start-index="28" stop-index="35">
                    <expr>
                        <column name="flag" start-index="32" stop-index="35" />
                    </expr>
                </not-expression>
            </expr>
        </where>
    </select>

    <select sql-case-id="presto_select_not_exists_subquery">
        <from>
            <simple-table name="t_order" start-index="14" stop-index="20" />
        </from>
        <projections start-index="7" stop-index="7">
            <shorthand-projection start-index="7" stop-index="7" />
        </projections>
        <where start-index="22" stop-index="48">
            <expr>
                <exists-subquery start-index="32" stop-index="48">
                    <not>true</not>
                    <subquery start-index="39" stop-index="48">
                        <select>
                            <projections start-index="47" stop-index="47">
                                <expression-projection text="1" start-index="47" stop-index="47">
                                    <expr>
                                        <literal-expression value="1" start-index="47" stop-index="47" />
                                    </expr>
                                </expression-projection>
                            </projections>
                        </select>
                    </subquery>
                </exists-subquery>
            </expr>
        </where>
    </select>

    <select sql-case-id="presto_select_predicate_variants">
        <from>
            <simple-table name="t_order" start-index="14" stop-index="20" />
        </from>
        <projections start-index="7" stop-index="7">
            <shorthand-projection start-index="7" stop-index="7" />
        </projections>
        <where start-index="22" stop-index="125">
            <expr>
                <binary-operation-expression start-index="28" stop-index="125">
                    <left>
                        <binary-operation-expression start-index="28" stop-index="104">
                            <left>
                                <binary-operation-expression start-index="28" stop-index="80">
                                    <left>
                                        <between-expression start-index="28" stop-index="55">
                                            <not>true</not>
                                            <left>
                                                <column name="order_id" start-index="28" stop-index="35" />
                                            </left>
                                            <between-expr>
                                                <literal-expression value="1" start-index="49" stop-index="49" />
                                            </between-expr>
                                            <and-expr>
                                                <literal-expression value="5" start-index="55" stop-index="55" />
                                            </and-expr>
                                        </between-expression>
                                    </left>
                                    <operator>AND</operator>
                                    <right>
                                        <binary-operation-expression start-index="61" stop-index="80">
                                            <left>
                                                <column name="status" start-index="61" stop-index="66" />
                                            </left>
                                            <operator>REGEXP</operator>
                                            <right>
                                                <literal-expression value="[12]" start-index="75" stop-index="80" />
                                            </right>
                                        </binary-operation-expression>
                                    </right>
                                </binary-operation-expression>
                            </left>
                            <operator>AND</operator>
                            <right>
                                <binary-operation-expression start-index="86" stop-index="104">
                                    <left>
                                        <column name="status" start-index="86" stop-index="91" />
                                    </left>
                                    <operator>RLIKE</operator>
                                    <right>
                                        <literal-expression value="[34]" start-index="99" stop-index="104" />
                                    </right>
                                </binary-operation-expression>
                            </right>
                        </binary-operation-expression>
                    </left>
                    <operator>AND</operator>
                    <right>
                        <binary-operation-expression start-index="110" stop-index="125">
                            <left>
                                <column name="status" start-index="110" stop-index="115" />
                            </left>
                            <operator>LIKE</operator>
                            <right>
                                <list-expression start-index="122" stop-index="125">
                                    <items>
                                        <literal-expression value="ok" start-index="122" stop-index="125" />
                                    </items>
                                </list-expression>
                            </right>
                        </binary-operation-expression>
                    </right>
                </binary-operation-expression>
            </expr>
        </where>
    </select>

    <select sql-case-id="presto_select_case_binary_variable">
        <from>
            <simple-table name="t_order" start-index="104" stop-index="110" />
        </from>
        <projections start-index="7" stop-index="97">
            <expression-projection text="CASE catalog.schem1.order_id WHEN 1 THEN 'one' ELSE 'other' END" start-index="7" stop-index="69">
                <expr>
                    <case-when-expression>
                        <case-expr start-index="12" stop-index="34">
                            <column name="order_id" start-index="12" stop-index="34">
                                <owner name="schem1" start-index="20" stop-index="25">
                                    <owner name="catalog" start-index="12" stop-index="18" />
                                </owner>
                            </column>
                        </case-expr>
                        <when-exprs>
                            <literal-expression value="1" start-index="41" stop-index="41" />
                        </when-exprs>
                        <then-exprs>
                            <literal-expression value="one" start-index="48" stop-index="52" />
                        </then-exprs>
                        <else-expr>
                            <literal-expression value="other" start-index="59" stop-index="65" />
                        </else-expr>
                    </case-when-expression>
                </expr>
            </expression-projection>
            <column-projection name="status" start-index="79" stop-index="84" />
            <expression-projection text="@user_value" start-index="87" stop-index="97">
                <expr>
                    <variable-segment text="@user_value" start-index="87" stop-index="97" variable="user_value" />
                </expr>
            </expression-projection>
        </projections>
    </select>

    <select sql-case-id="presto_select_concat_match_interval">
        <from>
            <simple-table name="t_order" start-index="96" stop-index="102" />
        </from>
        <projections start-index="7" stop-index="89">
            <expression-projection text="status || 'X'" start-index="7" stop-index="19">
                <expr>
                    <binary-operation-expression start-index="7" stop-index="19">
                        <left>
                            <column name="status" start-index="7" stop-index="12" />
                        </left>
                        <operator>||</operator>
                        <right>
                            <literal-expression value="X" start-index="17" stop-index="19" />
                        </right>
                    </binary-operation-expression>
                </expr>
            </expression-projection>
            <expression-projection text="MATCH(status) AGAINST ('kw')" start-index="22" stop-index="49">
                <expr>
                    <common-expression text="MATCH(status) AGAINST ('kw')" start-index="22" stop-index="49" />
                </expr>
            </expression-projection>
            <expression-projection text="INTERVAL" start-index="52" stop-index="59">
                <expr>
                    <function function-name="INTERVAL" text="INTERVAL" start-index="52" stop-index="59">
                        <parameter>
                            <literal-expression value="1" start-index="61" stop-index="63" />
                        </parameter>
                        <parameter>
                            <literal-expression value="DAY" start-index="65" stop-index="67" />
                        </parameter>
                    </function>
                </expr>
            </expression-projection>
            <expression-projection text="catalog.fn(order_id)" start-index="70" stop-index="89">
                <expr>
                    <function function-name="catalog.fn(order_id)" text="catalog.fn(order_id)" start-index="70" stop-index="89">
                        <parameter>
                            <column name="order_id" start-index="81" stop-index="88" />
                        </parameter>
                    </function>
                </expr>
            </expression-projection>
        </projections>
    </select>

    <select sql-case-id="presto_select_is_true">
        <from>
            <simple-table name="t_order" start-index="14" stop-index="20" />
        </from>
        <projections start-index="7" stop-index="7">
            <shorthand-projection start-index="7" stop-index="7" />
        </projections>
        <where start-index="22" stop-index="39">
            <expr>
                <binary-operation-expression start-index="28" stop-index="39">
                    <left>
                        <column name="flag" start-index="28" stop-index="31" />
                    </left>
                    <operator>IS</operator>
                    <right>
                        <literal-expression value="TRUE" start-index="36" stop-index="39" />
                    </right>
                </binary-operation-expression>
            </expr>
        </where>
    </select>

    <select sql-case-id="presto_select_xor">
        <from>
            <simple-table name="t_order" start-index="14" stop-index="20" />
        </from>
        <projections start-index="7" stop-index="7">
            <shorthand-projection start-index="7" stop-index="7" />
        </projections>
        <where start-index="22" stop-index="37">
            <expr>
                <binary-operation-expression start-index="28" stop-index="37">
                    <left>
                        <column name="flag" start-index="28" stop-index="31" />
                    </left>
                    <operator>XOR</operator>
                    <right>
                        <literal-expression value="1" start-index="37" stop-index="37" />
                    </right>
                </binary-operation-expression>
            </expr>
        </where>
    </select>

    <select sql-case-id="presto_select_safe_equal">
        <from>
            <simple-table name="t_order" start-index="14" stop-index="20" />
        </from>
        <projections start-index="7" stop-index="7">
            <shorthand-projection start-index="7" stop-index="7" />
        </projections>
        <where start-index="22" stop-index="40">
            <expr>
                <binary-operation-expression start-index="28" stop-index="40">
                    <left>
                        <column name="flag" start-index="28" stop-index="31" />
                    </left>
                    <operator>&lt;=&gt;</operator>
                    <right>
                        <literal-expression value="true" start-index="37" stop-index="40" />
                    </right>
                </binary-operation-expression>
            </expr>
        </where>
    </select>

    <select sql-case-id="presto_select_member_of">
        <from>
            <simple-table name="t_order" start-index="14" stop-index="20" />
        </from>
        <projections start-index="7" stop-index="7">
            <shorthand-projection start-index="7" stop-index="7" />
        </projections>
        <where start-index="22" stop-index="54">
            <expr>
                <binary-operation-expression start-index="28" stop-index="54">
                    <left>
                        <column name="order_id" start-index="28" stop-index="35" />
                    </left>
                    <operator>MEMBER OF</operator>
                    <right>
                        <expression-projection text="&quot;[1,2]&quot;" start-index="47" stop-index="53" />
                    </right>
                </binary-operation-expression>
            </expr>
        </where>
    </select>

    <select sql-case-id="presto_select_in_params">
        <from>
            <simple-table name="t_order" start-index="14" stop-index="20" />
        </from>
        <projections start-index="7" stop-index="7">
            <shorthand-projection start-index="7" stop-index="7" />
        </projections>
        <where start-index="22" stop-index="45">
            <expr>
                <in-expression start-index="28" stop-index="45">
                    <not>false</not>
                    <left>
                        <column name="order_id" start-index="28" stop-index="35" />
                    </left>
                    <right>
                        <list-expression start-index="40" stop-index="45">
                            <items>
                                <literal-expression value="1" start-index="41" stop-index="41" />
                            </items>
                            <items>
                                <literal-expression value="2" start-index="44" stop-index="44" />
                            </items>
                        </list-expression>
                    </right>
                </in-expression>
            </expr>
        </where>
    </select>

    <select sql-case-id="presto_select_sounds_like">
        <from>
            <simple-table name="t_order" start-index="14" stop-index="20" />
        </from>
        <projections start-index="7" stop-index="7">
            <shorthand-projection start-index="7" stop-index="7" />
        </projections>
        <where start-index="22" stop-index="50">
            <expr>
                <binary-operation-expression start-index="28" stop-index="50">
                    <left>
                        <column name="status" start-index="28" stop-index="33" />
                    </left>
                    <operator>SOUNDS LIKE</operator>
                    <right>
                        <literal-expression value="ok" start-index="47" stop-index="50" />
                    </right>
                </binary-operation-expression>
            </expr>
        </where>
    </select>

    <select sql-case-id="presto_select_searched_case">
        <from>
            <simple-table name="t_order" start-index="45" stop-index="51" />
        </from>
        <projections start-index="7" stop-index="38">
            <expression-projection text="CASE WHEN flag THEN 1 ELSE 0 END" start-index="7" stop-index="38">
                <expr>
                    <case-when-expression>
                        <when-exprs>
                            <column name="flag" start-index="17" stop-index="20" />
                        </when-exprs>
                        <then-exprs>
                            <literal-expression value="1" start-index="27" stop-index="27" />
                        </then-exprs>
                        <else-expr>
                            <literal-expression value="0" start-index="34" stop-index="34" />
                        </else-expr>
                    </case-when-expression>
                </expr>
            </expression-projection>
        </projections>
    </select>

    <select sql-case-id="presto_select_in_subquery">
        <from>
            <simple-table name="t_order" start-index="14" stop-index="20" />
        </from>
        <projections start-index="7" stop-index="7">
            <shorthand-projection start-index="7" stop-index="7" />
        </projections>
        <where start-index="22" stop-index="74">
            <expr>
                <in-expression start-index="28" stop-index="74">
                    <not>false</not>
                    <left>
                        <column name="order_id" start-index="28" stop-index="35" />
                    </left>
                    <right>
                        <subquery start-index="40" stop-index="74">
                            <select>
                                <projections start-index="48" stop-index="55">
                                    <column-projection name="order_id" start-index="48" stop-index="55" />
                                </projections>
                                <from start-index="57" stop-index="74">
                                    <simple-table name="t_order_item" start-index="62" stop-index="73" />
                                </from>
                            </select>
                        </subquery>
                    </right>
                </in-expression>
            </expr>
        </where>
    </select>

    <select sql-case-id="presto_select_convert_function">
        <projections start-index="7" stop-index="29">
            <expression-projection text="CONVERT(order_id, CHAR)" start-index="7" stop-index="29">
                <expr>
                    <function function-name="CONVERT" text="CONVERT(order_id, CHAR)" start-index="7" stop-index="29" />
                </expr>
            </expression-projection>
        </projections>
        <from>
            <simple-table name="t_order" start-index="36" stop-index="42" />
        </from>
    </select>

    <select sql-case-id="presto_select_position_function">
        <projections start-index="7" stop-index="28">
            <expression-projection text="POSITION('a' IN 'abc')" start-index="7" stop-index="28">
                <expr>
                    <function function-name="POSITION" text="POSITION('a' IN 'abc')" start-index="7" stop-index="28">
                        <parameter>
                            <literal-expression value="a" start-index="16" stop-index="18" />
                        </parameter>
                        <parameter>
                            <literal-expression value="abc" start-index="23" stop-index="27" />
                        </parameter>
                    </function>
                </expr>
            </expression-projection>
        </projections>
    </select>

    <select sql-case-id="presto_select_current_user">
        <projections start-index="7" stop-index="20">
            <expression-projection text="CURRENT_USER()" start-index="7" stop-index="20">
                <expr>
                    <function function-name="CURRENT_USER" text="CURRENT_USER()" start-index="7" stop-index="20" />
                </expr>
            </expression-projection>
        </projections>
    </select>

    <select sql-case-id="presto_select_limit_offset">
        <from>
            <simple-table name="t_order" start-index="14" stop-index="20" />
        </from>
        <projections start-index="7" stop-index="7">
            <shorthand-projection start-index="7" stop-index="7" />
        </projections>
        <limit start-index="22" stop-index="37">
            <row-count value="5" start-index="28" stop-index="28" />
            <offset value="2" start-index="37" stop-index="37" />
        </limit>
    </select>

    <select sql-case-id="presto_select_substring_function">
        <projections start-index="7" stop-index="26">
            <expression-projection text="SUBSTRING('abc',1,2)" start-index="7" stop-index="26">
                <expr>
                    <function function-name="SUBSTRING" text="SUBSTRING('abc',1,2)" start-index="7" stop-index="26">
                        <parameter>
                            <literal-expression value="abc" start-index="17" stop-index="21" />
                        </parameter>
                        <parameter>
                            <literal-expression value="1" start-index="23" stop-index="23" />
                        </parameter>
                        <parameter>
                            <literal-expression value="2" start-index="25" stop-index="25" />
                        </parameter>
                    </function>
                </expr>
            </expression-projection>
        </projections>
    </select>

    <select sql-case-id="presto_select_char_function">
        <projections start-index="7" stop-index="17">
            <expression-projection text="CHAR(97,98)" start-index="7" stop-index="17">
                <expr>
                    <function function-name="CHAR" text="CHAR(97,98)" start-index="7" stop-index="17">
                        <parameter>
                            <literal-expression value="97" start-index="12" stop-index="13" />
                        </parameter>
                        <parameter>
                            <literal-expression value="98" start-index="15" stop-index="16" />
                        </parameter>
                    </function>
                </expr>
            </expression-projection>
        </projections>
    </select>

    <select sql-case-id="presto_select_trim_function">
        <projections start-index="7" stop-index="33">
            <expression-projection text="TRIM(BOTH 'x' FROM 'xabcx')" start-index="7" stop-index="33">
                <expr>
                    <function function-name="TRIM" text="TRIM(BOTH 'x' FROM 'xabcx')" start-index="7" stop-index="33">
                        <parameter>
                            <literal-expression value="BOTH" start-index="12" stop-index="15" />
                        </parameter>
                        <parameter>
                            <literal-expression value="x" start-index="17" stop-index="19" />
                        </parameter>
                        <parameter>
                            <literal-expression value="xabcx" start-index="26" stop-index="32" />
                        </parameter>
                    </function>
                </expr>
            </expression-projection>
        </projections>
    </select>

    <select sql-case-id="presto_select_extract_function">
        <projections start-index="7" stop-index="42">
            <expression-projection text="EXTRACT(YEAR FROM DATE '2020-01-01')" start-index="7" stop-index="42">
                <expr>
                    <function function-name="EXTRACT" text="EXTRACT(YEAR FROM DATE '2020-01-01')" start-index="7" stop-index="42">
                        <parameter>
                            <literal-expression value="YEAR" start-index="15" stop-index="18" />
                        </parameter>
                        <parameter>
                            <literal-expression value="2020-01-01" start-index="25" stop-index="41" />
                        </parameter>
                    </function>
                </expr>
            </expression-projection>
        </projections>
    </select>

    <select sql-case-id="presto_select_weight_string">
        <projections start-index="7" stop-index="24">
            <expression-projection text="WEIGHT_STRING('a')" start-index="7" stop-index="24">
                <expr>
                    <function function-name="WEIGHT_STRING" text="WEIGHT_STRING('a')" start-index="7" stop-index="24">
                        <parameter>
                            <literal-expression value="a" start-index="21" stop-index="23" />
                        </parameter>
                    </function>
                </expr>
            </expression-projection>
        </projections>
    </select>

    <select sql-case-id="presto_select_group_concat">
        <projections start-index="7" stop-index="28">
            <expression-projection text="GROUP_CONCAT(order_id)" start-index="7" stop-index="28">
                <expr>
                    <function function-name="GROUP_CONCAT" text="GROUP_CONCAT(order_id)" start-index="7" stop-index="28">
                        <parameter>
                            <column name="order_id" start-index="20" stop-index="27" />
                        </parameter>
                    </function>
                </expr>
            </expression-projection>
        </projections>
        <from>
            <simple-table name="t_order" start-index="35" stop-index="41" />
        </from>
    </select>

    <select sql-case-id="presto_select_union">
        <projections start-index="7" stop-index="7">
            <shorthand-projection start-index="7" stop-index="7" />
        </projections>
        <from>
            <simple-table name="table1" start-index="14" stop-index="19" />
        </from>
        <combine combine-type="UNION" start-index="21" stop-index="46">
            <left>
                <projections start-index="7" stop-index="7">
                    <shorthand-projection start-index="7" stop-index="7" />
                </projections>
                <from>
                    <simple-table name="table1" start-index="14" stop-index="19" />
                </from>
            </left>
            <right>
                <projections start-index="34" stop-index="34">
                    <shorthand-projection start-index="34" stop-index="34" />
                </projections>
                <from>
                    <simple-table name="table2" start-index="41" stop-index="46" />
                </from>
            </right>
        </combine>
    </select>

    <select sql-case-id="presto_select_union_all">
        <projections start-index="7" stop-index="7">
            <shorthand-projection start-index="7" stop-index="7" />
        </projections>
        <from>
            <simple-table name="table1" start-index="14" stop-index="19" />
        </from>
        <combine combine-type="UNION_ALL" start-index="21" stop-index="50">
            <left>
                <projections start-index="7" stop-index="7">
                    <shorthand-projection start-index="7" stop-index="7" />
                </projections>
                <from>
                    <simple-table name="table1" start-index="14" stop-index="19" />
                </from>
            </left>
            <right>
                <projections start-index="38" stop-index="38">
                    <shorthand-projection start-index="38" stop-index="38" />
                </projections>
                <from>
                    <simple-table name="table2" start-index="45" stop-index="50" />
                </from>
            </right>
        </combine>
    </select>

    <select sql-case-id="presto_select_with_except">
        <projections start-index="8" stop-index="8">
            <shorthand-projection start-index="8" stop-index="8" />
        </projections>
        <from>
            <simple-table name="t1" start-index="15" stop-index="16" />
        </from>
        <combine combine-type="EXCEPT" start-index="19" stop-index="43">
            <left>
                <projections start-index="8" stop-index="8">
                    <shorthand-projection start-index="8" stop-index="8" />
                </projections>
                <from>
                    <simple-table name="t1" start-index="15" stop-index="16" />
                </from>
            </left>
            <right>
                <projections start-index="34" stop-index="34">
                    <shorthand-projection start-index="34" stop-index="34" />
                </projections>
                <from>
                    <simple-table name="t2" start-index="41" stop-index="42" />
                </from>
            </right>
        </combine>
    </select>

    <select sql-case-id="presto_select_limit_only">
        <from>
            <simple-table name="t_order" start-index="14" stop-index="20" />
        </from>
        <projections start-index="7" stop-index="7">
            <shorthand-projection start-index="7" stop-index="7" />
        </projections>
        <limit start-index="22" stop-index="28">
            <row-count value="5" start-index="28" stop-index="28" />
        </limit>
    </select>

    <select sql-case-id="presto_select_current_time_precision">
        <projections start-index="7" stop-index="21">
            <expression-projection text="CURRENT_TIME(3)" start-index="7" stop-index="21">
                <expr>
                    <function function-name="CURRENT_TIME" text="CURRENT_TIME(3)" start-index="7" stop-index="21">
                        <parameter>
                            <literal-expression value="3" start-index="20" stop-index="20" />
                        </parameter>
                    </function>
                </expr>
            </expression-projection>
        </projections>
    </select>

    <select sql-case-id="presto_select_predicate_not_variants">
        <from>
            <simple-table name="t_order" start-index="14" stop-index="20" />
        </from>
        <projections start-index="7" stop-index="7">
            <shorthand-projection start-index="7" stop-index="7" />
        </projections>
        <where start-index="22" stop-index="153">
            <expr>
                <binary-operation-expression start-index="28" stop-index="153">
                    <left>
                        <binary-operation-expression start-index="28" stop-index="126">
                            <left>
                                <binary-operation-expression start-index="28" stop-index="98">
                                    <left>
                                        <binary-operation-expression start-index="28" stop-index="69">
                                            <left>
                                                <binary-operation-expression start-index="28" stop-index="43">
                                                    <left>
                                                        <column name="flag" start-index="28" stop-index="31" />
                                                    </left>
                                                    <operator>IS</operator>
                                                    <right>
                                                        <literal-expression value="NOT NULL" start-index="36" stop-index="43" />
                                                    </right>
                                                </binary-operation-expression>
                                            </left>
                                            <operator>AND</operator>
                                            <right>
                                                <binary-operation-expression start-index="49" stop-index="69">
                                                    <left>
                                                        <column name="status" start-index="49" stop-index="54" />
                                                    </left>
                                                    <operator>NOT LIKE</operator>
                                                    <right>
                                                        <list-expression start-index="65" stop-index="69">
                                                            <items>
                                                                <literal-expression value="%x%" start-index="65" stop-index="69" />
                                                            </items>
                                                        </list-expression>
                                                    </right>
                                                </binary-operation-expression>
                                            </right>
                                        </binary-operation-expression>
                                    </left>
                                    <operator>AND</operator>
                                    <right>
                                        <binary-operation-expression start-index="75" stop-index="98">
                                            <left>
                                                <column name="status" start-index="75" stop-index="80" />
                                            </left>
                                            <operator>NOT REGEXP</operator>
                                            <right>
                                                <literal-expression value="[12]" start-index="93" stop-index="98" />
                                            </right>
                                        </binary-operation-expression>
                                    </right>
                                </binary-operation-expression>
                            </left>
                            <operator>AND</operator>
                            <right>
                                <binary-operation-expression start-index="104" stop-index="126">
                                    <left>
                                        <column name="status" start-index="104" stop-index="109" />
                                    </left>
                                    <operator>NOT RLIKE</operator>
                                    <right>
                                        <literal-expression value="[34]" start-index="121" stop-index="126" />
                                    </right>
                                </binary-operation-expression>
                            </right>
                        </binary-operation-expression>
                    </left>
                    <operator>AND</operator>
                    <right>
                        <in-expression start-index="132" stop-index="153">
                            <not>true</not>
                            <left>
                                <column name="order_id" start-index="132" stop-index="139" />
                            </left>
                            <right>
                                <list-expression start-index="148" stop-index="153">
                                    <items>
                                        <literal-expression value="1" start-index="149" stop-index="149" />
                                    </items>
                                    <items>
                                        <literal-expression value="2" start-index="152" stop-index="152" />
                                    </items>
                                </list-expression>
                            </right>
                        </in-expression>
                    </right>
                </binary-operation-expression>
            </expr>
        </where>
    </select>

    <select sql-case-id="presto_select_collate_params">
        <projections start-index="7" stop-index="53">
            <expression-projection text="utf8mb4_bin" start-index="7" stop-index="29">
                <expr>
                    <collate-expression start-index="7" stop-index="29" literal-stop-index="29">
                        <collate-name>
                            <literal-expression value="utf8mb4_bin" start-index="11" stop-index="29" />
                        </collate-name>
                        <expr>
                            <literal-expression value="a" start-index="7" stop-index="9" />
                        </expr>
                    </collate-expression>
                </expr>
            </expression-projection>
            <expression-projection text="latin1_bin" start-index="32" stop-index="53">
                <expr>
                    <collate-expression start-index="32" stop-index="53" literal-stop-index="53">
                        <collate-name>
                            <literal-expression value="latin1_bin" start-index="36" stop-index="53" />
                        </collate-name>
                        <expr>
                            <literal-expression value="b" start-index="32" stop-index="34" />
                        </expr>
                    </collate-expression>
                </expr>
            </expression-projection>
        </projections>
        <from>
            <simple-table name="t_order" start-index="60" stop-index="66" />
        </from>
    </select>

    <select sql-case-id="presto_select_agg_group_having_order">
        <from>
            <simple-table name="t_order" start-index="61" stop-index="67" />
        </from>
        <projections distinct-row="true" start-index="16" stop-index="54">
            <column-projection name="status" start-index="16" stop-index="21" />
            <aggregation-distinct-projection type="COUNT" expression="(DISTINCT order_id)" distinct-inner-expression="order_id" alias="cnt" start-index="24" stop-index="47" />
        </projections>
        <group-by start-index="69" stop-index="83">
            <column-item name="status" start-index="78" stop-index="83" />
        </group-by>
        <having start-index="85" stop-index="103">
            <expr>
                <binary-operation-expression start-index="92" stop-index="103">
                    <left>
                        <aggregation-projection type="COUNT" expression="(*)" start-index="92" stop-index="99">
                            <inner-expression>*</inner-expression>
                        </aggregation-projection>
                    </left>
                    <operator>&gt;</operator>
                    <right>
                        <literal-expression value="1" start-index="103" stop-index="103" />
                    </right>
                </binary-operation-expression>
            </expr>
        </having>
        <order-by>
            <index-item index="2" order-direction="DESC" start-index="114" stop-index="114" />
            <column-item name="status" order-direction="ASC" start-index="122" stop-index="127" />
        </order-by>
    </select>

    <select sql-case-id="presto_select_window_clause">
        <from>
            <simple-table name="t_order" start-index="34" stop-index="40" />
        </from>
        <projections start-index="7" stop-index="27">
            <expression-projection text="ROW_NUMBER() OVER win" start-index="7" stop-index="27">
                <expr>
                    <function function-name="ROW_NUMBER" text="ROW_NUMBER() OVER win" start-index="7" stop-index="27" />
                </expr>
            </expression-projection>
        </projections>
        <window start-index="42" stop-index="143">
            <window-item start-index="49" stop-index="143">
                <window-name>win</window-name>
                <partition-by>
                    <expression-projection text="status" start-index="70" stop-index="75">
                        <expr>
                            <column name="status" start-index="70" stop-index="75" />
                        </expr>
                    </expression-projection>
                </partition-by>
                <order-by>
                    <column-item name="order_id" order-direction="ASC" start-index="86" stop-index="93" />
                </order-by>
                <frame>
                    <common-expression text="ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW" start-index="95" stop-index="142" />
                </frame>
            </window-item>
        </window>
    </select>

    <select sql-case-id="presto_select_lock_for_update">
        <from>
            <simple-table name="t_order" start-index="14" stop-index="20" />
        </from>
        <projections start-index="7" stop-index="7">
            <shorthand-projection start-index="7" stop-index="7" />
        </projections>
        <lock start-index="22" stop-index="31" />
    </select>

    <select sql-case-id="presto_values_constructor">
        <projections start-index="0" stop-index="15">
            <expression-projection text="VALUES ROW(1, 2)" start-index="0" stop-index="15">
                <expr>
                    <values-expression>
                        <values>
                            <value>
                                <assignment-value>
                                    <literal-expression value="1" start-index="11" stop-index="11" />
                                </assignment-value>
                                <assignment-value>
                                    <literal-expression value="2" start-index="14" stop-index="14" />
                                </assignment-value>
                            </value>
                        </values>
                    </values-expression>
                </expr>
            </expression-projection>
        </projections>
    </select>

    <select sql-case-id="presto_table_statement">
        <from>
            <simple-table name="t_order" start-index="0" stop-index="12" />
        </from>
    </select>

    <select sql-case-id="presto_select_limit_comma">
        <from>
            <simple-table name="t_order" start-index="14" stop-index="20" />
        </from>
        <projections start-index="7" stop-index="7">
            <shorthand-projection start-index="7" stop-index="7" />
        </projections>
        <limit start-index="22" stop-index="31">
            <offset value="2" start-index="28" stop-index="28" />
            <row-count value="5" start-index="31" stop-index="31" />
        </limit>
    </select>

    <select sql-case-id="presto_select_join_natural_left">
        <projections start-index="7" stop-index="7">
            <shorthand-projection start-index="7" stop-index="7" />
        </projections>
        <from>
            <join-table join-type="LEFT" natural="true" start-index="14" stop-index="51">
                <left>
                    <simple-table name="t_order" start-index="14" stop-index="20" />
                </left>
                <right>
                    <simple-table name="t_order_item" start-index="40" stop-index="51" />
                </right>
            </join-table>
        </from>
    </select>

    <select sql-case-id="presto_select_system_variable">
        <projections start-index="7" stop-index="24">
            <expression-projection text="@@global.time_zone" start-index="7" stop-index="24">
                <expr>
                    <variable-segment text="@@global.time_zone" start-index="7" stop-index="24" variable="time_zone" scope="global" />
                </expr>
            </expression-projection>
        </projections>
    </select>

</sql-parser-test-cases>
